(function(a){"use strict";var b=Storages.initNamespaceStorage("paragonGridConditions"),c=b.localStorage,d=function(a,b){c.set(a,b)},e=function(a){return c&&!c.isEmpty(a)?c.get(a):null},f=function(a,b){var c={modalId:"conditionManagerModal",href:paragonCmm.getUrl("/cmm/modal/schCondMngModal.include"),title:"Search Condition Info.",params:{modalId:"conditionManagerModal",gridId:a},cbFnc:b,width:1152,height:"auto",resizable:!0,top:"20px"};paragonCmm.isMobile()&&(c=$.extend(c,{resizable:!1,width:"80%",height:"50%",buttons:[{id:"selectAllBtn",text:"<i class=\"fa fa-check\"></i> \uC804\uCCB4\uC120\uD0DD"},{id:"condsInit",text:"<i class=\"fa fa-refresh\"></i> \uB9AC\uC14B"},{id:"condsSave",text:"<i class=\"fa fa-save\"></i> \uC800\uC7A5"}]})),htmlUtils.openDialog(c)},g=function(a){var b=$.extend({},{gridId:null,idAttr:"id",nameAttr:"title",initConds:[],allCondDatas:[],viewCondsDatas:[]},a);if(!Array.isArray(b.initConds))throw new Error("initConds \uAC00 \uBC30\uC5F4\uC774 \uC544\uB2D9\uB2C8\uB2E4.");if(!Array.isArray(b.allCondDatas))throw new Error("allCondDatas \uAC00 \uBC30\uC5F4\uC774 \uC544\uB2D9\uB2C8\uB2E4.");if(!Array.isArray(b.viewCondsDatas))throw new Error("viewCondsDatas \uAC00 \uBC30\uC5F4\uC774 \uC544\uB2D9\uB2C8\uB2E4.");if(0===b.viewCondsDatas.length)b.viewCondsDatas=[],b.initConds.forEach(function(a){b.allCondDatas.some(function(c){c[b.idAttr]===a&&b.viewCondsDatas.push(c)})});else{var c=[];b.viewCondsDatas.forEach(function(a){var d=a[b.idAttr];b.allCondDatas.some(function(a){a[b.idAttr]===d&&c.push(a)})}),b.viewCondsDatas=c.concat([])}return b},h=function(a){var b=$.extend(e(a.gridId),a),c=new g(b);d(a.gridId,c);var h=c.idAttr,i=c.nameAttr,j=function(a){c.viewCondsDatas=[],a.forEach(function(a){c.allCondDatas.some(function(b){b[c.idAttr]===a&&c.viewCondsDatas.push(b)})})},k=function(a){var b=a.type,c=a[h],d="";switch(b){case"INPUT":d="<input type='text' name='"+c+"' class='form-control form-control-sm' placeholder='"+filterXSS(a[i])+"'>";break;case"FROM_TO_INPUT":d+="<div class='form-inline'>",d+="<input type='text' name='"+a.fromId+"' class='form-control form-control-sm' style='width:46%;' placeholder='"+filterXSS(a[i])+"'>",d+=" <span class='p-1'> ~ </span> ",d+="<input type='text' name='"+a.toId+"' class='form-control form-control-sm' style='width:46%;' placeholder='"+filterXSS(a[i])+"'>",d+="</div>";break;case"SELECT":d="<select name='"+c+"' class='form-control form-control-sm'></select>";break;case"MULTI_SELECT":d+="<div class='form-inline'>",$(a.opt).each(function(a,b){d+="<select name='"+b.targetNm+"' style='width:"+b.width+";display:inline-block;' class='form-control form-control-sm' data-type='search'></select>",d+="&nbsp;&nbsp;"}),d+="</div>";break;case"CHECKBOX":d="<input name='"+c+"' class='form-control form-control-sm'>";break;case"FROM_TO_CAL":d+="<div class='form-inline'>",d+="<input name='"+a.fromId+"' class='form-control form-control-sm' style='width:46%;' placeholder='YYYY-MM-DD'>",d+=" <span class='p-1'> ~ </span> ",d+="<input name='"+a.toId+"' class='form-control form-control-sm' style='width:46%;' placeholder='YYYY-MM-DD'>",d+="</div>";break;case"CALENDAR":d="<input name='"+c+"' class='form-control form-control-sm' style='width:46%;'>";break;default:}return d},l=function(a){c=e(c.gridId);var b="";c.viewCondsDatas.forEach(function(a){b+="<div class='form-group col-md-4'>",b+="    <div class='row'>",b+="        <label class='col-sm-3 col-form-label col-form-label-sm d-none d-sm-block'>",b+=filterXSS(a[i]),b+="        </label>",b+="        <div class='col-sm-9'>",b+=k(a),b+="        </div>",b+="    </div>",b+="</div>"}),$(a).html(""),$(a).html(b),c.viewCondsDatas.forEach(function(b){var c=b.type,d=b[h],e=b.opt;switch(c){case"SELECT":e.targetId=$(a).find("select[name="+d+"]"),htmlUtils.getCodeSelectOpt(e);break;case"MULTI_SELECT":$(b.opt).each(function(b,c){c.targetId=$(a).find("select[name="+c.targetNm+"]"),htmlUtils.getCodeSelectOpt(c)}),b.opt.forEach(function(b){var c=[].concat(b.events);c.forEach(function(c){c&&b.targetId.on(c.type,function(){var b;c.targetNm&&(b=$(a).find("select[name="+c.targetNm+"]"));var d=paragonCmm.getCbFnc(c.handlerId);return"function"==typeof d&&d($(this),b),!1})})});break;case"CHECKBOX":var f=$(a).find("span[name="+d+"]");htmlUtils.loadCodeStr({parentCd:e.parentCd,fields:e.fields,callBackFnc:function(a){f.html(htmlUtils.getInputCheckbox(d,a,""))}});break;case"FROM_TO_CAL":var g=$(a).find("input[name="+b.fromId+"]"),i=$(a).find("input[name="+b.toId+"]"),j={validType:"validDate"};b.hasOwnProperty("formatter")&&"YearMonth"===b.formatter&&(j={formatter:function(a){var b=a.getFullYear(),c=a.getMonth()+1;return b+"-"+(10>c?"0"+c:c)},parser:function(a){if("string"==typeof a&&0===a.trim().length)return new Date;var b=Date.parse(a+"-01");return isNaN(b)?new Date:new Date(b)}}),g.datebox(j),i.datebox(j);break;case"CALENDAR":var k=$(a).find("input[name="+d+"]");k.datebox({validType:"validDate"});default:}})};return{setViewCondDatas:j,getViewCondDatas:function(){return c=e(c.gridId),c.viewCondsDatas},getAllCondDatas:function(){return c.allCondDatas},getInitConds:function(){return c.initConds},getGridId:function(){return c.gridId},getIdAttr:function(){return c.idAttr},getNameAttr:function(){return c.nameAttr},makeSch:l,setConds:function(){d(c.gridId,c)},getConds:function(){c=e(c.gridId)},openConditionMng:f}};a.condition=function(){return{createObj:function(a){return new h(a)}}}()})(paragonCmm);